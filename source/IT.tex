%
% IT.
% Information Technology
%
% Aleph Objects Operations Manual
%
% Copyright (C) 2014, 2015 Aleph Objects, Inc.
%
% This document is licensed under the Creative Commons Attribution 4.0
% International Public License (CC BY-SA 4.0) by Aleph Objects, Inc.
%

\section{Network}
The Aleph Objects network is comprised of workstations, phones and servers at
Aleph Mountain and our upstream providers. See figure
\ref{fig:ao_net_overview} for an overview of Aleph Objects' network,
figure \ref{fig:ao_net_sfdp} for a detailed network diagram, and
figure \ref{fig:ao_net_dia} for an older network diagram.

\begin{figure}[h!]
% The ao-network-overview.pdf built in calligraflow.
\includegraphics[keepaspectratio=true,height=1.10\textheight,width=1.00\textwidth,angle=0]{ao-network-overview.pdf}
 \caption{Aleph Objects Network Overview, May, 2015}
 \label{fig:ao_net_overview}
\end{figure}

\section{Servers}
In general, the servers are all running the latest stable release of Debian,
Jessie, version 8, on the amd64 architecture. Some are running Wheezy because
the daemon they hosts prefers it. There is some Debian Squeeze, which is being
migrated. The firewalls are OpenBSD. There is one CentOS and one Fedora
machine.

All machines are backed up at least daily. Updates are run at least weekly,
sooner depending on the nature of the update.

\subsection{Aleph Mountain Servers}
This is a list of servers and nodes that are in the Aleph Mountain building.

\begin{itemize}
\item \texttt{abejas.alephobjects.com} --- Apache, OpenERP.
\item \texttt{amfw1.alephobjects.com} --- OpenBSD, PF, authpf.
\item \texttt{amfw2.alephobjects.com} --- OpenBSD, PF.
\item \texttt{aobuild1.alephobjects.com} --- Compile/build server.
\item \texttt{aocluster1.alephobjects.com} --- 3D Printer cluster Botqueue
       server.
\item \texttt{aodb.alephobjects.com} --- Postgres.
\item \texttt{aogfs1.alephobjects.com} --- Test, potential fileserver.
\item \texttt{aomds1.alephobjects.com} --- Test, potential db server.
\item \texttt{cam.alephobjects.com} --- Motion, Motioneye video camera server.
\item \texttt{jebstation.alephobjects.com} --- sshfs file server.
\item \texttt{tunk.alephobjects.com} --- apt-cacher, OpenVPN server, dnsmasq
      (dhcp, dns cache, tftp), MySQL, OpenLDAP.
\end{itemize}

\subsection{Virtual Servers Elastichosts Los Angeles}
These are machines ``in the cloud''.

\begin{itemize}
\item \texttt{aomail.alephobjects.com} --- Apache, Roundcube.
\item \texttt{analytics.alephobjects.com}  --- Apache, Piwik, MySQL.
\item \texttt{cal.alephobjects.com} --- Calendarserver.
\item \texttt{develdrupal.lulzbot.com} --- Test server. Apache, Drupal,
       Ubercart, MySQL.
\item \texttt{develerp.alephobjects.com} --- Test server. OpenERP, Postgres.
\item \texttt{dodev.alephobjects.com} --- Test server. Odoo, Postgres.
\item \texttt{drupalsql.lulzbot.com} --- MySQL.
\item \texttt{drupalsqlslave.lulzbot.com} --- MySQL, Offline.
\item \texttt{forum.lulzbot.com} --- Apache, phpBB, MySQL.
\item \texttt{jabber.alephobjects.com} --- ejabberd.
\item \texttt{ldap.alephobjects.com} --- OpenLDAP.
\item \texttt{ohai-kit.alephobjects.com} --- Apache, OHAI-Kit, MySQL.
\item \texttt{ops.alephobjects.com} --- Apache, Opsview.
\item \texttt{phplist.alephobjects.com} --- Apache, phplist.
\item \texttt{projects.alephobjects.com} --- Apache, OpenProjects, MySQL.
\item \texttt{survey.alephobjects.com} --- Apache, LimeSurvey.
\item \texttt{thinkup.alephobjects.com} --- Apache, ThinkUp, MySQL, Offline.
\item \texttt{www.lulzbot.com} --- Apache, Drupal, Ubercart.
\item \texttt{www.alephobjects.com} --- Apache, HTML.  :)
\end{itemize}

\subsection{Virtual Servers Elastichosts Dallas}
These are machines ``in the cloud''.

\begin{itemize}
\item \texttt{download.alephobjects.com} --- Apache, vsftpd, rsyncd.
\item \texttt{fone.alephobjects.com} --- Asterisk.
\item \texttt{mail.alephobjects.com} --- Postfix, dovecot, spamassassin, MySQL.
\item \texttt{wiki.alephobjects.com} --- Test server. Apache, Mediawiki, MySQL.
\end{itemize}

\subsection{Tummy Servers}
The CentOS server at Tummy.

\begin{itemize}
\item \texttt{belly1.alephobjects.com} --- Tummy Backup server.
\end{itemize}

\section{Public Services}
\subsection{Public URLs}
\begin{itemize}
\item \url{https://www.alephobjects.com} --- Main Aleph Objects website.
\item \url{https://www.lulzbot.com} --- Main LulzBot website.
\item \url{https://devel.alephobjects.com} --- Public development files for
       Aleph Objects.
\item \url{https://devel.lulzbot.com} --- Public development files for LulzBot.
\item \url{https://download.alephobjects.com} --- Aleph Objects downloads.
\item \url{https://download.lulzbot.com} --- Final release source code for
       LulzBot products.
\item \url{https://forum.lulzbot.com} --- User discussion forum for LulzBot.
\item \url{https://ohai-kit.alephobjects.com} --- Visual work instructions for
       assembling products and user support.
\item \url{https://phplist.alephobjects.com} --- Newletter mailing list.
\item \url{https://survey.alephobjects.com} --- Surveys.
\item \url{rsync://rsync.alephobjects.com} --- Rsync file server of download
       and development archives.
\end{itemize}

\section{Employee Services}
\subsection{Employee URLs}
These are URLs that are for Aleph Objects employees.

\begin{itemize}
\item \url{https://analytics.alephobjects.com} --- Website analytics.
\item \url{https://aomail.alephobjects.com} --- Webmail server.
\item \url{https://belly1.alephobjects.com} --- Backup server.
\item \url{https://erp.alephobjects.com} --- ERP server.
\item \url{https://ops.alephobjects.com} --- Network monitoring.
\item \url{https://projects.alephobjects.com} --- Project tracking.
\item \url{https://wiki.alephobjects.com} --- Development wiki.
\end{itemize}

\section{Server Daemons}
These are the server daemons used to drive the enterprise.

\subsection{\href{http://sourceforge.net/projects/acpid2/}{ACPID}}
Monitors ACPI events. Runs on nearly all servers and workstations.

\subsection{\href{http://httpd.apache.org/}{Apache}}
Web daemon, used on many servers.

\subsection{\href{http://www.asterisk.org}{Asterisk}}
Telephone server. DIDs (incoming), termination (outgoing), forwarding of calls, conferencing,
voicemail, XMPP.

\subsection{\href{https://github.com/tummy-dot-com/tummy-backup}{Backups}}
tummy-backup backup server.

\subsection{\href{http://www.isc.org/}{BIND}}
Nameserver used for caching.

\subsection{\href{http://www.botqueue.org/}{botqueue}}
Print queue manager.

\subsection{\href{http://www.debian.org/}{buildd}}
Build service for compiling Debian packages.

\subsection{\href{http://www.calendarserver.org/}{Calendar Server}}
Calendar (CalDAV) and contacts (CardDAV) server. CalDAV is used with mobile
phones and icedove. No group calendars. CardDav is unused. Uses python-twisted.

Needs to be connected to or replaced by LDAP.

\subsection{\href{http://ftp.isc.org/isc/cron/}{cron}}
Scheduled triggering of applications (cf. at).

\subsection{\href{http://dnsmasq.org/}{DHCP}}
dnsmasq DHCP for 350+ hosts.

\subsection{\href{http://dnsmasq.org/}{DNS}}
dnsmasq DNS caching.

\subsection{\href{http://dnsmasq.org/}{Dovecot}}
IMAP mail services. Employees check their mail via the
IMAP server, typically using icedove or aomail (roundcube using IMAP).

\subsection{\href{http://www.drupal.org}{Drupal}}
Main LulzBot site.

Used with \href{http://www.ubercart.org/}{UberCart}.
Migrating to Drupal Commerce.

\subsection{\href{http://www.exim.org/}{exim}}
SMTP outgoing mail server, used by default in Debian. Used by some servers.

\subsection{\href{http://www.openbsd.org/faq/pf/}{Firewalls}}
OpenBSD's PF, authpf, Linux's iptables.

\subsection{\href{http://www.fail2ban.org/}{fail2ban}}
Block out scripts, bots, crackers, and network noise on servers.

\subsection{\href{http://www.debian.org/}{Init}}
Init, woo!

\subsection{md RAID}
Linux RAID, md, mdadm.

\subsection{\href{http://www.mediawiki.org/}{Mediawiki}}
Test/development server for customer support.

\subsection{\href{http://www.memcached.org/}{memcached}}
Used to speed up websites, such as Drupal.

\subsection{\href{http://motion.sf.net}{Motion}}
Motion detection for video camera system. Cameras are aggregated
using \href{https://bitbucket.org/ccrisan/motioneye/wiki/Home}{motionEye}.

\subsection{\href{http://munin-monitoring.org/}{Munin}}
Network graphing.

\subsection{\href{http://www.mysql.org/}{MySQL}}
Used on many servers for a database.

\subsection{\href{http://support.ntp.org/}{NTP}}
Syncs time on every server and workstation.

\subsection{\href{http://www.odoo.com/}{Odoo}}
Development ERP server, next generation of OpenERP.

\subsection{\href{http://www.openerp.org/}{OpenERP}}
ERP server.

\subsection{\href{http://www.openldap.org/}{OpenLDAP}}
LDAP server. Running, but not actively used. Daemon is slapd.

\subsection{\href{http://www.openssh.com/}{OpenSSH}}
Used to control every server, create encrypted tunnels (autossh),
mount filesystems (sshfs), and remote file transfer (sftp).

\subsection{\href{http://openvpn.net/}{OpenVPN}}
Connects external resources, such as employee mobiles and laptops, to the internal network.

\subsection{\href{http://www.opsview.com/}{Opsview}}
Network monitoring (cf. nagios).

\subsection{\href{http://community.pentaho.com/}{Pentaho}}
Report server, connects to ERP.

\subsection{\href{https://www.piwiki.org/}{Piwik}}
Application to analyze web site traffic.

\href{http://www.mrunix.net/webalizer/}{Webalizer} is used occassionally.

\subsection{\href{https://www.phpbb.com/}{phpBB}}
User discussion forum.

\subsection{\href{http://www.postfix.org/}{Postfix}}
Main SMTP outgoing mail server.

\subsection{\href{http://www.postgresql.org/}{Postgres}}
Database server.

\subsection{\href{http://rsync.samba.org/}{rsync}}
File server.

\subsection{\href{http://www.rsyslog.com/}{rsyslog}}
Logging on every server and workstation.

\subsection{\href{http://www.openbsd.org/cgi-bin/man.cgi/OpenBSD-current/man8/sendmail.8?query=sendmail&sec=8}{sendmail}}
SMTP outgoing mail server, used by default in OpenBSD.

\subsection{\href{http://www.spamassassin.org/}{spamassassin}}
Spam filtering of email.

\subsection{\href{http://fuse.sourceforge.net/sshfs.html}{sshfs}}
Main internal fileserver.

\subsection{\href{http://www.freedesktop.org/wiki/Software/systemd}{systemd}}
System bootup and process manager.

\subsection{\href{http://dnsmasq.org/}{TFTP}}
Network install server.

\subsection{\href{http://vsftpd.beasts.org/}{vsftpd}}
vsftpd FTP server for public facing download and devel servers.

\subsection{\href{http://www.xinetd.org}{xinetd}}
xinetd on Debian systems. inetd on OpenBSD. Misc network utils.

\subsection{\href{http://www.ejabberd.im/}{XMPP/jabber}}
ejabberd, Erlang XMPP (jabber) server.


\section{3D Printer Cluster}
There are 144 printers in the 3D printing cluster. One hundred thirty five are
in the main cluster room, nine in the adjoining sample room. The cluster is a
mix of LulzBot TAZ and LulzBot Minis.

Each printer has a Beaglebone Black (BBB) connected to it via USB. The
BBB is running Debian (armhf port) and Botqueue. There is a separate Botqueue
server, also running Debian, that the BBBs connect to, to get print jobs.

The printers are organized in sets, or ``pods'', typically of nine. Each cabinet
holds nine machines, three wide by three high. Each pod is assigned a letter.
In the main cluster room, this is A through O. In the sample room, it is pods
Y and Z which have five and four machines, respectively. Machines are named
of the format: bbb-a1, bbb-a2, through to bbb-a9 for the first pod. Then the
next pod starts bbb-b1, through to the end: bbb-z4.

List of printers:
\begin{itemize}
\item \texttt{bbb-a1.alephobjects.com} through
      \texttt{bbb-o9.alephobjects.com} --- LulzBot TAZ.
\item \texttt{bbb-y1.alephobjects.com} through
      \texttt{bbb-z4.alephobjects.com} --- LulzBot Mini.
\end{itemize}

Links to upstream:
\begin{itemize}
\item \href{http://beagleboard.org/}{BeagleBone Black}
\item \href{http://botqueue.org/}{BotQueue}
\item \href{https://wiki.debian.org/ArmHardFloatPort}{Debian armhf}
\end{itemize}

\section{Workstation Software}

All workstations run \href{http://www.debian.org/}{Debian} stable, version 8,
codename \href{https://www.debian.org/releases/jessie/}{Jessie}.

\subsection{Graphical User Interface (GUI) Applications}
\input{IT-GUI}

\subsection{Workstation Daemons}
\begin{itemize}
\item \href{http://ftp.isc.org/isc/cron/}{cron}
\item \href{http://www.cups.org/}{cups}
\item \href{http://www.isc.org/}{dhcp client}
\item \href{https://wiki.gnome.org/Projects/GDM}{gdm}
\item \href{http://support.ntp.org/}{ntp}
\end{itemize}

\section{Telephones}
\subsection{Hard Phones}
\begin{itemize}
\item \href{https://www.grandstream.com/products/ip-video-telephony/gxv3140/}{Grandstream GXV3140}
\item \href{https://www.grandstream.com/products/ip-video-telephony/gxv3175/}{Grandstream GXV3175}
\item \href{https://www.grandstream.com/products/ip-video-telephony/gxv3275/}{Grandstream GXV3275}
\item \href{http://www.google.com/nexus/5/}{Nexus 5}
\end{itemize}

\subsection{Cell Phones}
\begin{itemize}
\item Browser
\item Calendar
\item Camera
\item \href{https://chatsecure.org/}{ChatSecure}
\item \href{http://code.google.com/p/connectbot/}{ConnectBot}
\item \href{https://github.com/dschuermann/document-viewer}{Document Viewer}
\item Email
\item \href{https://f-droid.org/}{F-Droid}
\item File Manager
\item \href{http://www.mozilla.org/en-US/firefox/}{Firefox}
\item Gallery
\item \href{http://code.google.com/p/k9mail/}{K-9 Mail}
\item Messaging
\item Movie Studio
\item \href{https://code.google.com/p/ics-openvpn/}{OpenVPN for Android}
\item \href{https://omnirom.org/}{OmniROM}
\item People
\item Phone
\item Settings
\item Terminal Emulator
\item \href{https://github.com/momodalo/vimtouch}{VI IMproved Touch}
\item \href{http://www.videolan.org/vlc/download-android.html}{VLC}
\end{itemize}

\section{Network Diagrams}
See figure \ref{fig:ao_net_overview} for an overview of Aleph Objects' network from May, 2015.
%See figure \ref{fig:ao_net_dot} for an Aleph Objects network diagram from 2015-05.
%See figure \ref{fig:ao_net_neato} for an Aleph Objects network diagram from May, 2015.
See figure \ref{fig:ao_net_sfdp} for a detailed Aleph Objects network diagram from 2015-05.
See figure \ref{fig:ao_net_dia} for an older Aleph Objects network diagram from February, 2014.

%\begin{sidewaysfigure}[p]
%\thisfloatpagestyle{empty}
%% The ao-network-overview.pdf built in calligraflow.
%\includegraphics[keepaspectratio=true,height=1.10\textheight,width=1.00\textwidth,angle=0]{ao-network-overview.pdf}
% \caption{Aleph Objects Network Overview}
% \label{fig:ao_net_overview}
%\end{sidewaysfigure}

%\begin{sidewaysfigure}[p]
%\thisfloatpagestyle{empty}
%% The aonet-dot.png built with dot from aonet.dot source.
%\includegraphics[keepaspectratio=true,height=1.10\textheight,width=1.00\textwidth,angle=0]{aonet-dot.png}
% \caption{Aleph Objects Network Overview, dot}
% \label{fig:ao_net_dot}
%\end{sidewaysfigure}

%\begin{sidewaysfigure}[p]
%\thisfloatpagestyle{empty}
%% The aonet-neato.png built with neato from aonet.dot source.
%\includegraphics[keepaspectratio=true,height=1.10\textheight,width=1.00\textwidth,angle=0]{aonet-neato.png}
% \caption{Aleph Objects Network Overview, neato}
% \label{fig:ao_net_neato}
%\end{sidewaysfigure}

\begin{sidewaysfigure}[p]
\thisfloatpagestyle{empty}
% The aonet-sfdp.png built with sfdp from aonet.dot source.
\includegraphics[keepaspectratio=true,height=1.10\textheight,width=1.00\textwidth,angle=0]{aonet-sfdp.png}
 \caption{Aleph Objects Network Detail, May 2015}
 \label{fig:ao_net_sfdp}
\end{sidewaysfigure}

\begin{sidewaysfigure}[p]
\thisfloatpagestyle{empty}
% The ao-network.pdf was built in Dia.
\includegraphics[keepaspectratio=true,height=1.10\textheight,width=1.00\textwidth,angle=-90]{ao-network.pdf}
 \caption{Aleph Objects Network Diagram, February 2014}
 \label{fig:ao_net_dia}
\end{sidewaysfigure}

